{% extends "base.html" %}

{% block title %}{{ titulo }} - Sistema de Metas{% endblock %}

{% block extra_css %}{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h1 class="page-title mb-0">
        <i class="bi bi-person-{{ 'gear' if vendedor else 'plus' }}"></i> {{ titulo }}
    </h1>
    <a href="{{ url_for('lista_vendedores') }}" class="btn btn-secondary">
        <i class="bi bi-arrow-left"></i> Voltar
    </a>
</div>

<div class="form-card">
    <form method="POST" novalidate>
        {{ form.hidden_tag() }}
        
        <div class="row">
            <div class="col-md-6 mb-3">
                <label for="nome" class="form-label required">
                    <i class="bi bi-person form-icon"></i>Nome Completo
                </label>
                {{ form.nome(class="form-control" + (" is-invalid" if form.nome.errors else ""), placeholder="Ex: João Silva Santos") }}
                {% if form.nome.errors %}
                    <div class="invalid-feedback">
                        {{ form.nome.errors[0] }}
                    </div>
                {% endif %}
            </div>
            
            <div class="col-md-6 mb-3">
                <label for="email" class="form-label required">
                    <i class="bi bi-envelope form-icon"></i>Email
                </label>
                {{ form.email(class="form-control" + (" is-invalid" if form.email.errors else ""), placeholder="vendedor@empresa.com") }}
                {% if form.email.errors %}
                    <div class="invalid-feedback">
                        {{ form.email.errors[0] }}
                    </div>
                {% endif %}
            </div>
        </div>
        
        <div class="row">
            <div class="col-md-6 mb-3">
                <label for="telefone" class="form-label">
                    <i class="bi bi-telephone form-icon"></i>Telefone
                </label>
                {{ form.telefone(class="form-control" + (" is-invalid" if form.telefone.errors else ""), placeholder="(11) 98765-4321") }}
                {% if form.telefone.errors %}
                    <div class="invalid-feedback">
                        {{ form.telefone.errors[0] }}
                    </div>
                {% endif %}
            </div>
            
            <div class="col-md-6 mb-3">
                <label for="cpf" class="form-label">
                    <i class="bi bi-card-text form-icon"></i>CPF
                </label>
                {{ form.cpf(class="form-control" + (" is-invalid" if form.cpf.errors else ""), placeholder="000.000.000-00") }}
                {% if form.cpf.errors %}
                    <div class="invalid-feedback">
                        {{ form.cpf.errors[0] }}
                    </div>
                {% endif %}
            </div>
        </div>
        
        <div class="row">
            <div class="col-md-6 mb-4">
                <label for="supervisor_id" class="form-label">
                    <i class="bi bi-person-badge form-icon"></i>Supervisor
                </label>
                {{ form.supervisor_id(class="form-select" + (" is-invalid" if form.supervisor_id.errors else "")) }}
                {% if form.supervisor_id.errors %}
                    <div class="invalid-feedback">
                        {{ form.supervisor_id.errors[0] }}
                    </div>
                {% endif %}
                <small class="form-text text-muted">
                    <i class="bi bi-info-circle"></i> Opcional - Selecione o supervisor responsável por este vendedor
                </small>
            </div>
            
            <div class="col-md-6 mb-4">
                <label for="equipe_id" class="form-label">
                    <i class="bi bi-diagram-3-fill form-icon"></i>Equipe
                </label>
                {{ form.equipe_id(class="form-select" + (" is-invalid" if form.equipe_id.errors else "")) }}
                {% if form.equipe_id.errors %}
                    <div class="invalid-feedback">
                        {{ form.equipe_id.errors[0] }}
                    </div>
                {% endif %}
                <small class="form-text text-muted">
                    <i class="bi bi-info-circle"></i> Opcional - Adicione o vendedor a uma equipe
                </small>
            </div>
        </div>
        
        <hr class="my-4">
        
        <div class="d-flex justify-content-end gap-2">
            <a href="{{ url_for('lista_vendedores') }}" class="btn btn-cancel">
                <i class="bi bi-x-circle"></i> Cancelar
            </a>
            <button type="submit" class="btn btn-primary">
                <i class="bi bi-check-circle"></i> Salvar Vendedor
            </button>
        </div>
    </form>
</div>

<div class="alert alert-info mt-4" role="alert">
    <i class="bi bi-lightbulb"></i> <strong>Dica:</strong> 
    Após cadastrar o vendedor, você poderá criar metas mensais para acompanhar seu desempenho.
</div>
{% endblock %}

{% block extra_js %}
<script>
    // Máscara para telefone
    document.getElementById('telefone').addEventListener('input', function(e) {
        let value = e.target.value.replace(/\D/g, '');
        if (value.length <= 11) {
            value = value.replace(/^(\d{2})(\d)/g, '($1) $2');
            value = value.replace(/(\d)(\d{4})$/, '$1-$2');
        }
        e.target.value = value;
    });
    
    // Máscara para CPF
    document.getElementById('cpf').addEventListener('input', function(e) {
        let value = e.target.value.replace(/\D/g, '');
        value = value.replace(/(\d{3})(\d)/, '$1.$2');
        value = value.replace(/(\d{3})(\d)/, '$1.$2');
        value = value.replace(/(\d{3})(\d{1,2})$/, '$1-$2');
        e.target.value = value;
    });
</script>
{% endblock %}
